# Environment variables can be used anywhere in the config using ${VAR} or $VAR syntax.
# Example: ${MY_SECRET} or ${DATA_DIR:-/default/path} (with default value).
#
# Multiple config files can be merged with: --config base.yaml --config overrides.yaml
# Later files override earlier ones.

global:
  log_level: ${LOG_LEVEL:-info}
  client_logs_to_stdout: true
  docker_network: benchmarkoor
  cleanup_on_start: false
  # Optional directory configurations.
  # directories:
  #   # Directory for temporary datadir copies (defaults to system temp).
  #   tmp_datadir: ${TMP_DIR:-/tmp}/benchmarkoor
  #   # Directory for executor cache - git clones, etc (defaults to ~/.cache/benchmarkoor).
  #   tmp_cachedir: ${TMP_DIR:-/tmp}/benchmarkoor-cache

benchmark:
  results_dir: ${RESULTS_DIR:-./results}
  # Optional: Enable/disable system resource collection (cgroups/Docker Stats API).
  # When disabled, no CPU/memory/disk metrics will be collected during tests.
  # Useful when running in environments without cgroup access. Default: true
  # system_resource_collection_enabled: true
  # Optional: Generate index.json after benchmark (aggregates all run metadata).
  # generate_results_index: true
  # Optional: Generate stats.json per suite after benchmark (aggregates test durations
  # across runs for the UI heatmap).
  # generate_suite_stats: true
  # Optional test execution configuration.
  # tests:
  #   # Optional filter to run only tests matching this pattern.
  #   filter: ""
  #   source:
  #     # Option 1: Local directory source.
  #     # local:
  #     #   base_dir: ./benchmark-tests
  #     #   # Optional: Pre-run steps executed before tests (glob patterns).
  #     #   pre_run_steps:
  #     #     - "warmup/*.txt"
  #     #   # Test step patterns (glob patterns for setup/test/cleanup phases).
  #     #   steps:
  #     #     setup:
  #     #       - "tests/setup/*.txt"
  #     #     test:
  #     #       - "tests/test/*.txt"
  #     #     cleanup:
  #     #       - "tests/cleanup/*.txt"
  #
  #     # Option 2: Git repository source.
  #     # git:
  #     #   repo: https://github.com/example/gas-benchmarks.git
  #     #   version: main  # branch, tag, or commit hash
  #     #   # Optional: Pre-run steps executed before tests (glob patterns).
  #     #   pre_run_steps:
  #     #     - "funding/*.txt"
  #     #   # Test step patterns (glob patterns for setup/test/cleanup phases).
  #     #   steps:
  #     #     setup:
  #     #       - "tests/setup/*.txt"
  #     #     test:
  #     #       - "tests/test/*.txt"
  #     #     cleanup:
  #     #       - "tests/cleanup/*.txt"

client:
  config:
    # JWT secret for Engine API authentication (optional, has a default).
    # Can be set via environment variable for security.
    # jwt: ${JWT_SECRET:-5a64f13bfb41a147711492237995b437433bcbec80a7eb2daae11132098d7bae}
    # Genesis file URLs per client type
    genesis:
      besu: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/besu/zkevmgenesis.json
      erigon: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/geth/zkevmgenesis.json
      ethrex: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/geth/zkevmgenesis.json
      geth: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/geth/zkevmgenesis.json
      nethermind: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/nethermind/zkevmgenesis.json
      nimbus: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/geth/zkevmgenesis.json
      reth: https://github.com/nethermindeth/gas-benchmarks/raw/refs/heads/main/scripts/genesisfiles/geth/zkevmgenesis.json

  # Default images per client (used when 'image' is not specified):
  #   geth:       ethpandaops/geth:performance
  #   nethermind: ethpandaops/nethermind:performance
  #   besu:       ethpandaops/besu:performance
  #   erigon:     ethpandaops/erigon:performance
  #   nimbus:     statusim/nimbus-eth1:performance
  #   reth:       ethpandaops/reth:performance

  # Optional: Pre-populated data directories per client type.
  # When configured, the source directory is prepared and mounted into the container,
  # and the init container is skipped (data is already initialized).
  # datadirs:
  #   geth:
  #     source_dir: ./data/snapshots/geth
  #     container_dir: /data  # default, can be omitted
  #     # Method for preparing the data directory:
  #     #   copy          - parallel Go copy (default, works everywhere, has progress)
  #     #   overlayfs     - uses Linux overlayfs for near-instant setup (requires root)
  #     #   fuse-overlayfs - uses fuse-overlayfs for near-instant setup (no root required)
  #     #                    Requires: apt install fuse-overlayfs (or equivalent)
  #     #                    Requires: user_allow_other in /etc/fuse.conf if Docker runs as root
  #     #                    WARNING: fuse-overlayfs is SLOW compared to overlayfs. You'll get
  #     #                             3x Worse results.
  #     method: copy
  #   reth:
  #     source_dir: ./data/snapshots/reth
  #     container_dir: /root/.local/share/reth
  #     method: fuse-overlayfs  # near-instant, no root required

  instances:
    - id: geth-latest
      client: geth
      # image: ${GETH_IMAGE:-ethpandaops/geth:performance}
      # pull_policy: always (default)
      # Optional overrides:
      # entrypoint: []
      # command: []
      # extra_args:  # Additional arguments appended to command
      #   - --verbosity=5
      # restart: never
      # environment:
      #   SOME_VAR: ${MY_ENV_VAR}
      # genesis: <override-url>
      # datadir:  # Instance-level datadir (overrides global datadirs)
      #   source_dir: ${DATA_SNAPSHOTS_DIR}/geth
      #   container_dir: /data

    # Example: running multiple clients
    # - id: nethermind-latest
    #   client: nethermind
    #   # image: ethpandaops/nethermind:performance (default)

    # - id: besu-latest
    #   client: besu
    #   # image: ethpandaops/besu:performance (default)

    # - id: reth-latest
    #   client: reth
    #   # image: ethpandaops/reth:performance (default)

    # - id: erigon-latest
    #   client: erigon
    #   # image: ethpandaops/erigon:performance (default)

    # - id: nimbus-latest
    #   client: nimbus
    #   # image: statusim/nimbus-eth1:performance (default)
